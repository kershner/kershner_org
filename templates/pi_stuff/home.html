{% extends "pi_stuff/base.html" %}

{% block content %}
  {% csrf_token %}
  <button class="menu-button" type="button" aria-label="Open menu"></button>

  <div class="menu" id="menu" hidden>
    <div class="menu-inner">
      <div class="menu-header">
        <div class="menu-actions">
          <button data-action="reload" type="button">reload</button>
          <button data-action="qr" type="button">show qr</button>
          <button data-action="screen" type="button">screen</button>
        </div>

        <div class="menu-categories">
          <div class="category-btns">  
            {% for category in categories %}
            <button data-category="cat-{{ category.id }}" type="button">
              {{ category.name }}
            </button>
            {% endfor %}
          </div>

          <div class="random-btn">
            <button data-action="random" type="button">random</button>
          </div>
        </div>
      </div>

      <div class="menu-content">
        <div class="menu-playlists" id="playlists"></div>
        
        <div class="menu-qr" id="qr-container" hidden>
          <div class="qr-box">
            <img class="qr-img" src="data:image/png;base64,{{ qr_code_b64 }}" alt="QR Code">
            <button class="qr-regenerate-button" data-action="regenerate-qr" type="button">
              Regenerate QR Code
            </button>
          </div>
        </div>
      </div>

      <div class="menu-footer">
        <div class="menu-actions">
          <button data-action="close" type="button">close</button>
        </div>
      </div>
    </div>
  </div>

  <div id="player"></div>
{% endblock %}

{% block window_vars %}
  window.CATEGORIES_DATA = {{ categories_json|safe }};
  window.API_PLAY_URL = "{{ api_play_url }}";
  window.LATEST_URL = "{{ latest_url }}";
  window.REGENERATE_QR_URL = "{{ regenerate_qr_url }}";
{% endblock %}

{% block js_init %}
  PiStuff.init();
{% endblock %}